<!DOCTYPE html>
<html>
<head>
	<meta charset="ISO-8859-1">
	<title>Find Latitude and Longitude</title>
	<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-map/3.0-rc1/jquery.ui.map.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js"></script>
	<script type="text/javascript" src="../js/map.js"></script> 
    <style>
        #googleMap{
          height:550px;
          width:80%;
          margin-left: auto;
          margin-right: auto;
        }
        h1{
          font-family: 'Algerian';
          font-size: 40px;
          text-align: center;
        }
        body{
          background-color: #66a7f1;
        }
      </style>
</head>
<body>
	<input type="text" value="<%= num %>" id="num" hidden>
	<h3>Find Latitude and Longitude</h3>

	<select id="addMarkerBtnId">
		<option>-----------</option>
		<% date.forEach(function(n){ %>
		<option><%= n %></option>
		
		<% }); %>
	</select>
	<br/><br/>
	




	<div id="googleMap" style="width:100%;height:500px"></div>


	<script>
		$(function() {
	$("#googleMap").gmap({
		'zoom':3
	});
	
	var markers = [];
	
	$("#addMarkerBtnId").change(function() {
		markers = [];
		console.log(markers)
		var str= $("#addMarkerBtnId").val();
		var str1= $("#num").val();
		$.post("/request", {
                            name: "viSion",
                            designation: "Professional gamer",

                            num: str1,
                            date: str

                        },
						function(data, status) {
                            console.log(data);
							console.log(data[0].position.length)
			for (var i = 0; i< data[0].position.length; i++) {
				var marker = {
			"lat":data[0].position[i].la,
			"lng":data[0].position[i].lo,
		};
		markers.push(marker);
		
		$.each(markers, function(i, m) {
			$("#googleMap").gmap("addMarker", {
				"position":new google.maps.LatLng(m.lat, m.lng),
				"title":m.title
			}).click(function() {
				var contentString = "<table border='1'>" +
						"<tr><td>Place Name : </td><td>"+m.title+"</td></tr>" + 
						"<tr><td>Latitude : </td><td>"+m.lat+"</td></tr>" +
						"<tr><td>Longitude : </td><td>"+m.lng+"</td></tr>" +
						"</table>";
				$("#googleMap").gmap("openInfoWindow", {
					content:contentString
				}, this);
			});
			m={}
		});
		
			}
		});
		});
		
	});
</script>
    
</body>
</html>